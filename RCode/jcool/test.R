require(ggplot2)
require(Cairo)
require(reshape)
require(scales)
require(RColorBrewer)
require(grid)
library(gridExtra)
require(lattice)


#
# cherry-picker
#
rosenbrock = function(x,y){
  (1-x)**2 + 100*(y - x**2)**2
} 
#
g=expand.grid(xc = seq(-2,2,0.1), yc = seq(-1,3.5,0.1))
g$zc=rosenbrock(g$xc,g$yc)
#
wireframe(zc ~ xc * yc, data = g,type = "p", 
          scales = list(arrows = FALSE),
          drape = TRUE, colorkey = TRUE,pretty=TRUE, screen = list(z = 0, x =-65, y = 20),
          aspect = c(87/97, 0.6),
          col.regions = terrain.colors(100, alpha = 1) )

min(g$zc)
max(g$zc)
rosenbrock(1.2,1)

par(mfrow=c(2,1))
subseries=c(1.339335178115738, 1.0370564155342366, 0.07866638112847378, 0.001899399058149642, -0.2328761838774494, 0.16382780686983744, 2.0075696520947175, -1.304012984034916, -1.278521318052917, -0.1726409379849672, -0.18527541206723647, -0.3930277777135978, -1.403925635555475, -0.9224212363902522, -0.6073964077099883, 1.6686520768833408, 0.5830046847608186, -0.37991370105850186)
paa=c(1.3393351781157383, 1.154609267649265, 0.8240808523329555, 0.07866638112847378, 0.014693896069870324, -0.10244530446878325, -0.21083707328037787, 0.1638278068698375, 1.3929890370197573, 1.0876855865031523, -1.304012984034916, -1.2813537253842502, -0.7255811280189421, -0.17404476843855274, -0.18527541206723652, -0.3353187872562752, -0.7299937303275568, -1.4039256355554746, -0.9491714807883205, -0.7474074426789943, -0.22805499361110007, 1.6686520768833406, 0.8242596607880464, 0.20853642360886054, -0.379913701058502)
plot(subseries,type="l")
plot(paa,type="l")