require(Cairo)
require(png)
require(ggplot2)
require(reshape2)
require(png)
require(signal)

#
# read the data
train <- read.csv("../data/digits/test_outlied.csv", sep= " ", header=FALSE)

# get those numbers 3
set3 <- train[train[,1]==3,-1]

# plot the first one
image=matrix(as.vector(unlist(set3[3,])),nrow=28,ncol=28,byrow=T)
writePNG(image/256, "digits/3.png")

par(mfrow=c(1,1))
s=c(-0.34612230745149225, -0.31241344630465034, -0.026198125853112302, -0.18186457702723985, 0.30310762837873306, -0.1246040306825372, 0.3184325228553728, 0.7614690763932829, 0.6727682915656485, 1.0, 0.929060974066848, 0.7614690763932829, 0.3184325228553728, 0.1793740008335438, -0.01067886177088331, -0.21262162778128113, 0.1653953539259914, 0.6064496310619685, 0.8490369372787739, 0.8490369372787739, 0.6064496310619685, 0.1653953539259914, -0.21262162778128113, -0.01067886177088331, 0.1793740008335438, 0.6507099380088054, 0.5399507996243279, 0.758199185732715, 0.758199185732715, 0.9279279279279279, 0.758199185732715, 0.929060974066848, 0.7614690763932829, 0.3920897595459886, -0.1534264276484303, -0.26144680219835703, -0.5051793806312218, -0.23578313267801074, -0.02262814111007102, 0.11933166594877914, 0.2927700218845599, 0.7467286566323437, 0.7467286566323437, 0.8490369372787739, 0.758199185732715, 0.4677675811188185, 0.14285714285714285, -0.21262162778128113, -0.1246040306825372, -0.14769984339266268, -0.31645569620253167, -0.2698412698412698, -0.31645569620253167, -0.14769984339266268, -0.1246040306825372, -0.01067886177088331, 0.37070626838932386, 0.6727682915656485, 0.929060974066848, 1.0)
plot(s,type="l")
s1=c(1.3461223074514923, 1.3124134463046504, 1.0261981258531123, 1.1818645770272398, 0.6968923716212669, -1.1246040306825371, 0.6815674771446272, 0.23853092360671713, 0.32723170843435145, 0.0, 0.07093902593315204, 0.23853092360671713, 0.6815674771446272, 0.8206259991664562, 1.0106788617708833, 1.2126216277812811, 0.8346046460740086, 0.3935503689380315, 0.15096306272122606, 0.15096306272122606, 0.3935503689380315, 0.8346046460740086, 1.2126216277812811, 1.0106788617708833, 0.8206259991664562, 0.3492900619911946, 0.4600492003756721, 0.24180081426728495, 0.24180081426728495, 0.07207207207207211, 0.24180081426728495, 0.07093902593315204, 0.23853092360671713, 0.6079102404540113, 1.1534264276484303, 1.261446802198357, 1.5051793806312217, -1.2357831326780107, 1.022628141110071, 0.8806683340512209, 0.7072299781154401, 0.25327134336765633, 0.25327134336765633, 0.15096306272122606, 0.24180081426728495, -0.5322324188811816, -0.8571428571428572, -1.2126216277812811, -1.1246040306825371, -1.1476998433926626, -1.3164556962025316, -1.2698412698412698, 1.3164556962025316, 1.1476998433926626, 1.1246040306825371, 1.0106788617708833, 0.6292937316106761, 0.32723170843435145, 0.07093902593315204, 0.0)
plot(s1,type="l")

myfilter = butter(2, 0.1, type = 'low', plane='z')
yfiltered = filter(myfilter,s1) # apply filter
plot(c(1:length(s1)), s1, type = "l")
lines(c(1:length(s1)), yfiltered, col = "red")


bf <- butter(3, 0.1) # 10 Hz low-pass filter
t <- seq(0, 1, len = 100) # 1 second sample
x <- sin(2*pi*t*2.3) + 0.25*rnorm(length(t)) # 2.3 Hz sinusoid+noise
z <- filter(bf, x) # apply filter
plot(t, x, type = "l")
lines(t, z, col = "red")



bigify <- function(im, r){
  result <- matrix(nrow=nrow(im)*r, ncol=ncol(im)*r)
  for(i in 1:nrow(im)){
    for(j in 1:ncol(im)){
      for(k in 1:r){
        for(l in 1:r){
          result[(i - 1) * r + (k - 1) + 1, (j - 1) * r + (l - 1) + 1] <- im[i, j]
        }
      }
    }
  }
  return(result)
}

writePNG(image/256, "digits/3.png")


train <- read.csv("../data/train.csv", header=TRUE)

labels <- as.numeric(train[,1])
train <- train[,-1]

bigify <- function(im, r){
  result <- matrix(nrow=nrow(im)*r, ncol=ncol(im)*r)
  for(i in 1:nrow(im)){
    for(j in 1:ncol(im)){
      for(k in 1:r){
        for(l in 1:r){
          result[(i - 1) * r + (k - 1) + 1, (j - 1) * r + (l - 1) + 1] <- im[i, j]
        }
      }
    }
  }
  return(result)
}

images <- list()
for(x in 0:9){
  average <- colMeans(train[labels == x,])
  im <- t(matrix(1 - average/256, nrow = 28))
  im <- bigify(im, 8)
  images[[as.character(x)]] <- im
}

row1 <- matrix(nrow=28*8)
for(i in 0:4){
  row1 <- cbind(row1, images[[as.character(i)]])
}
row1 <- row1[,-1] # kills the NA row

row2 <- matrix(nrow=28*8)
for(i in 5:9){
  row2 <- cbind(row2, images[[as.character(i)]])
}
row2 <- row2[,-1] # kills the NA row

writePNG(rbind(row1, row2), "averages.png")
#
#
#

library(reshape2)
library(ggplot2)
dat=read.csv("../digits_reduced_50.csv",sep=" ")
series_2plot = 15
im <- matrix( 1 - as.vector(unlist(dat[series_2plot,-1]))/256,nrow=28,ncol=28,byrow=F)
im2 <- matrix( 1 - as.vector(unlist(dat[series_2plot,-1]))/256,nrow=28,ncol=28,byrow=F)
ggplot(melt(cbind(im,im2)), aes(Var1,-Var2,fill=value)) + geom_raster()


writePNG(im, "digits/averages.png")


d=c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 61, 118, 240, 255, 228, 105, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 66, 244, 253, 253, 174, 227, 236, 42, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 71, 237, 253, 120, 40, 8, 56, 186, 227, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 12, 189, 253, 225, 5, 0, 0, 0, 22, 198, 102, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 74, 253, 244, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 192, 253, 157, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 192, 253, 103, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 75, 252, 219, 3, 0, 0, 0, 0, 81, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 199, 253, 219, 0, 0, 0, 32, 128, 246, 250, 223, 46, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 213, 253, 219, 0, 36, 203, 223, 253, 253, 253, 253, 230, 48, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 213, 253, 119, 29, 154, 253, 236, 167, 68, 88, 253, 253, 169,
    7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 213, 253, 82, 151, 253, 241, 72, 0, 0, 10, 167,
    253, 253, 49, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 213, 253, 179, 209, 253, 65, 0, 0, 0,
    0, 7, 250, 253, 173, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 213, 253, 253, 246, 129, 3, 0,
    0, 0, 0, 0, 125, 253, 253, 54, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 157, 253, 253, 109, 0,
    0, 0, 0, 0, 0, 0, 125, 253, 253, 110, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 137, 152,
    14, 0, 0, 0, 0, 0, 0, 0, 17, 242, 253, 191, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 132, 253, 191, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 104, 253, 191, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 39, 232, 196, 18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 220, 253, 137, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0)
im <- matrix( 1 - d/256,nrow=28,ncol=28,byrow=F)
(p1=ggplot(melt(im), aes(Var1,-Var2,fill=value)) + geom_raster())

d=c(0.8079621855688683, 0.929060974066848, 0.6727682915656485, 0.37070626838932386, 0.6662144337146809, 0.2911392405063291, 0.08860759493670886, -0.014174775185418742, 0.27565892320998564, -0.16539535392599136, -0.14769984339266268, -0.31645569620253167, -0.2032905342780163, -0.27565892320998564, 0.1653953539259914, 0.7614690763932829, 1.0, 0.929060974066848, 0.4677675811188185, 0.4677675811188185, 0.929060974066848, 1.0, 1.0, 0.6727682915656485, 0.6727682915656485, 1.0, 0.8930108366813808, 0.6400326547015383, 0.2557107127473839, -0.2353631690670147, -0.4102773427573963, -0.2698412698412698, -0.34612230745149225, 0.11933166594877914, 0.37745515533680457, 0.6400326547015383, 0.8930108366813808, 0.6727682915656485, 0.37070626838932386, 0.626422431982715, 0.30310762837873306, -0.14769984339266268, -0.31645569620253167, -0.2698412698412698, 0.18338688097178613, 0.3394221166510653, 0.48936170212765956)
im <- data.frame(x=seq(1:length(d)),y=d)
(p2=ggplot(im, aes(x,y)) + geom_line())
