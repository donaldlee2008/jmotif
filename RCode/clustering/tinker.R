magnitude = function(a){
  sqrt(sum(a*a))
}

cosined = function(a,b){
  sum(a*b)/(magnitude(a)*magnitude(b))
}

normalizev = function(a){
  a/magnitude(a)
}

a <- c(2, 1, 0, 2, 0, 1, 1, 1)
b <- c(2, 1, 1, 1, 1, 0, 1, 1)

cosined(a,b)
cosined(normalizev(a),normalizev(b))

cos(pi)

a=normalizev(c(2,8))
b=normalizev(c(2,5))
m=(a+b)/magnitude(a+b)

dat=data.frame(points=c("a","b","m"),rbind(a,b,m))
names(dat)=c("points","x","y")

p <- ggplot(dat, aes(x = x, y = y, col=points))
(p <- p + geom_segment(aes(xend = 0, yend = 0)))

sum(m*m)

a=c(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.0, 0.10862716383186483, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1506498871021482, 0.10862716383186483, 0.1506498871021482, 0.1506498871021482, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.0, 0.29831641117777824, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.13188989423777203, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1506498871021482, 0.03267718809105355, 0.1506498871021482, 0.08404544654056674, 0.0, 0.0, 0.0, 0.0, 0.0, 0.29831641117777824, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.21510315270777514, 0.0, 0.10862716383186483, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.10862716383186483, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.0, 0.10862716383186483, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.06660444056158146, 0.0, 0.0, 0.0, 0.0, 0.29831641117777824, 0.0, 0.0, 0.04202272327028337, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.10862716383186483, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.06660444056158146, 0.0, 0.0, 0.0, 0.10862716383186483, 0.0, 0.0, 0.0, 0.0, 0.08404544654056674, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.10862716383186483, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1506498871021482, 0.0, 0.0, 0.0, 0.0, 0.06660444056158146, 0.0, 0.0, 0.0)
b=c(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.18042443753187495, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1300963134592855, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1300963134592855, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.1300963134592855, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1300963134592855, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1300963134592855, 0.18042443753187495, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1300963134592855, 0.1300963134592855, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.1300963134592855, 0.0, 0.0, 0.1300963134592855, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.18042443753187495, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1300963134592855, 0.0, 0.0, 0.1300963134592855, 0.0, 0.0)
